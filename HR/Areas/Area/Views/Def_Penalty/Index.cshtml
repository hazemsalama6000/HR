
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div ng-controller="Def_Penalty">

    <div class="panel panel-default" style="margin:10px;">
        <div class="panel-heading text-center">
            تعريف الجزاءات
        </div>

        <div class="panel-body">

            <input type="hidden" id="PenaltyTypes" value="@ViewBag.PenaltyTypes" />

            <div class="row">
                <div class="col-md-12">
                    <label class="btn btn-danger col-md-3" ng-click="AddDef_Penalty()"> اضافة جزاء جديد </label>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-12">
                    <table class="table table-striped table-bordered table-hover">
                        <tr>
                            <th>الجزاء</th>
                            <th> القيمة </th>
                            <th> الايام </th>
                        </tr>
                        <tr ng-repeat="x in PenaltyTypes">
                            <td>{{x.Name}}</td>
                            <td>{{x.Value}}</td>
                            <td>{{x.Daysnum}}</td>
                            <td>
                                <label class="btn btn-primary" ng-click="EditDef_Penalty(x.ID)"> تعديل </label>
                                <label class="btn btn-danger" ng-click="DeleteDef_Penalty(x.ID)"> حذف </label>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

        </div>

    </div>

</div>


<script>

    var app = angular.module("Hr",[]);
    app.controller("Def_Penalty", function ($scope, $http, $compile, $filter) {
        putMenu();
        $scope.PenaltyTypes = angular.fromJson(  $("#PenaltyTypes").val() );
          
        $scope.AddDef_Penalty = function () {
            $scope.PenaltyType = {};
            $http.get("/Area/Def_Penalty/AddDef_Penalty").then(function (res) {
                $("#myModal").empty();
                $el = $("#myModal").html(res.data);
                $compile($el)($scope);
                $("#myModal").modal('show');
            });
        }


        $scope.AddDef_PenaltyEnd = function () {
            $http.post("/Area/Def_Penalty/AddDef_PenaltyEnd", $scope.PenaltyType).then(function (res) {
                $scope.PenaltyTypes = angular.fromJson(res.data.result);
                alert(res.data.msg);
            });
        }



        $scope.EditDef_Penalty = function (ID) {
            $scope.PenaltyType = {};
            $http.get("/Area/Def_Penalty/EditDef_Penalty?ID="+ID).then(function (res) {
                $("#myModal").empty();
                $el = $("#myModal").html(res.data);
                $compile($el)($scope);
                $scope.PenaltyType = angular.fromJson($("#PenaltyType").val());
                $("#myModal").modal('show');
            });
        }
        $scope.EditDef_PenaltyEnd = function () {
            $http.post("/Area/Def_Penalty/EditDef_PenaltyEnd", $scope.PenaltyType).then(function (res) {
                $scope.PenaltyTypes = angular.fromJson(res.data.result);
                alert(res.data.msg);
            });
        }




        $scope.DeleteDef_Penalty = function (ID) {
            $http.get("/Area/Def_Penalty/DeleteDef_Penalty?ID="+ID).then(function (res) {
                $scope.PenaltyTypes = angular.fromJson(res.data.result);
                alert(res.data.msg);
            });

        }

    
    });

</script>

















